[![Build Status](https://travis-ci.org/nhartland/forma.svg?branch=master)](https://travis-ci.org/nhartland/forma)
[![Coverage Status](https://coveralls.io/repos/github/nhartland/forma/badge.svg?branch=master)](https://coveralls.io/github/nhartland/forma?branch=master)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](https://opensource.org/licenses/MIT)

forma
=====

__2D grid shape generation in Lua__ 

<p align="center">
  <img width="650" height="320" src="https://i.imgur.com/si0FhKN.png">
</p>

**forma** is a utility library for the procedural generation and manipulation of
shapes on a two dimensional grid or lattice. It came about as part of
experiments in making roguelike games. **forma** is therefore particularly
suited for (but not limited to) the generation of roguelike environments.

Shapes can be generated in several ways. From simple rasters of primitive shapes
like circles, lines and squares, to pattern generation by a [Cellular
Automata](https://en.wikipedia.org/wiki/Cellular_automaton) (CA) implementation,
including both synchronous and asynchronous update rules. Using the CA methods,
patterns such as the classic 4-5 rule 'cave' systems can be generated:

<p align="center">
  <img width="650" height="320" src="https://i.imgur.com/r6D7hxb.png">
</p>

However the real power of the CA implementation is in its flexibility.
Different CA rules with custom cellular *neighbourhoods* (including
[Moore](https://en.wikipedia.org/wiki/Moore_neighborhood), [von
Neumann](https://en.wikipedia.org/wiki/Von_Neumann_neighborhood) and more) may
be combined. Patterns can also be recursively generated by nesting the result of
one pattern in another. Interesting structures can therefore be formed by
combining different CA rule sets with different neighbourhoods and domains. For
example a 'corridor' structure:

<p align="center">
  <img width="650" height="320" src="https://i.imgur.com/PF7cMw7.png">
</p>

In addition to pattern generation tools, **forma** implements several useful
methods for the manipulation of patterns. Basic operations such as pattern
addition or subtraction, enlargement and reflection are included. On top of
these, more involved methods such as flood-filling, Voronoi tessellation, hull
finding or Binary Space Partitioning are also available. Once again most of
these operations can be performed under custom definitions of the cellular
neighbourhood.

## Installation

**forma** is compatible with Lua 5.1, 5.2, 5.3 and LuaJIT 2.0, 2.1. The library
is written in pure Lua, no compilation is required. Including the project is as
simple as including the `forma` directory in your project or Lua path.

The easiest way to do this is via LuaRocks:

```Shell
    luarocks install forma
```

## Generating documentation

Documentation is hosted [here](https://nhartland.github.io/forma/).

Generating the documentation requires
 - [LDoc](https://github.com/stevedonovan/LDoc)

Simply running 

    ldoc --output contents --dir docs .

in the root directory should generate all the required pages.

## Testing

Unit tests and coverage reports are provided. The test suite requires
 - [LuaCov](https://keplerproject.github.io/luacov/)
 - [luaunit](https://github.com/bluebird75/luaunit)

To run the tests use

    ./run_tests.sh
